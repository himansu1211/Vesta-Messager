import{r as i,j as e,_ as I,$ as R}from"./vendor-4ab45f55.js";import{i as T,g as V,a as O,b as $,G as F,q as A,o as M,c as j,d as E,e as N,s as y,u as q,f as v,r as B,h as K,j as W,w as _,k as Y,l as Z,m as J,n as X}from"./vendor-firebase-6b6c2e36.js";import{I as Q,F as H,L as D,P as ee,S as ae,U,X as C,a as G,b as se,c as te,d as re,C as ne,M as P,Z as le,e as ie,f as oe}from"./vendor-icons-7ddd601d.js";import{A as L,m as z}from"./vendor-framer-c5d6f702.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))m(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&m(o)}).observe(document,{childList:!0,subtree:!0});function c(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function m(n){if(n.ep)return;n.ep=!0;const l=c(n);fetch(n.href,l)}})();const de={apiKey:"AIzaSyCactoGYTEBZ1ap1SAkjo2iuxgEKdAGI1A",authDomain:"vesta-messenger-5337e.firebaseapp.com",projectId:"vesta-messenger-5337e",storageBucket:"vesta-messenger-5337e.firebasestorage.app",messagingSenderId:"590499217282",appId:"1:590499217282:web:12bf0d7c30f9dd2f6e199b",measurementId:"G-VQ38TVL6XL"},S=T(de),k=V(S),f=O(S),ce=$(S),me=new F,xe=({room:s,user:r})=>{const[c,m]=i.useState([]),[n,l]=i.useState(""),[o,x]=i.useState(!1),u=i.useRef(null),h=t=>{if(!t)return"";const a=t.toDate(),g=new Date-a;return g<6e4?"Just now":g<36e5?`${Math.floor(g/6e4)}m ago`:g<864e5?a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):g<6048e5?a.toLocaleDateString("en-US",{weekday:"long"}):a.toLocaleDateString("en-US",{month:"short",day:"numeric"})};i.useEffect(()=>{const t=A(j(f,"rooms",s.id,"messages"),M("createdAt","asc")),a=E(t,d=>{var g;m(d.docs.map(p=>({id:p.id,...p.data()}))),(g=u.current)==null||g.scrollIntoView({behavior:"smooth"})});return()=>a()},[s.id]);const b=async t=>{if(t.preventDefault(),!n.trim())return;const a=n;l(""),await N(j(f,"rooms",s.id,"messages"),{text:a,senderEmail:r.email,createdAt:y(),type:"text"}),await q(v(f,"rooms",s.id),{lastMessage:a,updatedAt:y()})},w=async t=>{const a=t.target.files[0];if(a)try{x(!0);const d=B(ce,`vesta/${s.id}/${Date.now()}_${a.name}`),g=await K(d,a),p=await W(g.ref);await N(j(f,"rooms",s.id,"messages"),{fileUrl:p,fileName:a.name,fileType:a.type,senderEmail:r.email,createdAt:y(),type:"file"}),x(!1)}catch(d){console.error("Upload failed",d),alert("Upload failed. Make sure your Storage Rules are set to public!"),x(!1)}};return e.jsxs("div",{className:"flex flex-col h-full bg-gradient-to-b from-slate-50 to-white",children:[e.jsxs("div",{className:"p-4 bg-white/80 backdrop-blur-md border-b border-slate-200/50 flex items-center gap-3 shadow-lg z-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-3xl bg-orange-500 text-white flex items-center justify-center font-bold text-sm shadow-lg animate-pulse",children:s.type==="group"?"G":"D"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-bold text-gray-800 text-lg",children:s.type==="group"?s.name:s.members.find(t=>t!==r.email)}),e.jsx("p",{className:"text-xs text-slate-500",children:s.type==="group"?`${s.members.length} members`:"Direct Message"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gradient-to-b from-slate-50/50 to-white custom-scrollbar",children:[c.map(t=>{var a;return e.jsx("div",{className:`flex ${t.senderEmail===r.email?"justify-end":"justify-start"} group`,children:e.jsxs("div",{className:`p-4 rounded-3xl max-w-[75%] shadow-lg transition-all hover:shadow-xl ${t.senderEmail===r.email?"bg-gradient-to-r from-orange-500 to-pink-500 text-white rounded-tr-md":"bg-white border border-slate-200/50 text-gray-800 rounded-tl-md"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("p",{className:"text-xs opacity-70 font-bold lowercase",children:t.senderEmail.split("@")[0]}),e.jsxs("span",{className:"text-xs opacity-50 flex items-center gap-1",children:[e.jsx(Clock,{size:10}),h(t.createdAt)]})]}),t.type==="file"?e.jsxs("a",{href:t.fileUrl,target:"_blank",rel:"noreferrer",className:"flex items-center gap-3 hover:underline p-2 rounded-xl bg-black/10 transition-all",children:[(a=t.fileType)!=null&&a.includes("image")?e.jsx(Q,{size:24,className:"text-blue-500"}):e.jsx(H,{size:24,className:"text-gray-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm font-medium truncate block",children:t.fileName}),e.jsx("span",{className:"text-xs opacity-70",children:"Click to view"})]})]}):e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:t.text})]})},t.id)}),e.jsx("div",{ref:u})]}),e.jsxs("form",{onSubmit:b,className:"p-4 bg-white/80 backdrop-blur-md border-t border-slate-200/50 flex gap-3 items-center shadow-lg",children:[e.jsxs("label",{className:"cursor-pointer text-slate-400 hover:text-orange-500 p-3 rounded-2xl hover:bg-orange-50 transition-all hover:scale-110",children:[o?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"animate-spin",size:22}),e.jsx("span",{className:"text-xs font-medium",children:"Sending..."})]}):e.jsx(ee,{size:22}),e.jsx("input",{type:"file",className:"hidden",onChange:w,disabled:o})]}),e.jsx("input",{className:"flex-1 bg-white/80 backdrop-blur-sm p-4 rounded-3xl outline-none text-sm border border-slate-200/50 focus:border-orange-500 focus:bg-white transition-all shadow-md focus:shadow-orange-100",placeholder:"Type a message...",value:n,onChange:t=>l(t.target.value)}),e.jsx("button",{disabled:!n.trim()||o,className:"bg-orange-500 text-white p-4 rounded-3xl hover:bg-orange-600 transition-all disabled:opacity-50 disabled:bg-gray-300 shadow-lg hover:shadow-xl hover:scale-105 disabled:hover:scale-100",children:e.jsx(ae,{size:20})})]})]})},ge=({isOpen:s,onClose:r,userEmail:c})=>{const[m,n]=i.useState(""),[l,o]=i.useState(""),[x,u]=i.useState([]),h=()=>{const t=l.trim().toLowerCase();t&&!x.includes(t)&&t!==c&&(u([...x,t]),o(""))},b=t=>{u(x.filter(a=>a!==t))},w=async()=>{if(!m.trim())return alert("Please enter a group name");if(x.length===0)return alert("Add at least one member");try{await N(j(f,"rooms"),{name:m,type:"group",members:[c,...x],createdBy:c,updatedAt:y(),lastMessage:`Group "${m}" created`}),n(""),u([]),r()}catch(t){console.error("Error creating group:",t),alert("Failed to create group. Check your connection.")}};return s?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-md overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"bg-orange-500 p-6 text-white flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{size:24}),e.jsx("h2",{className:"text-xl font-bold italic tracking-tight",children:"Create Vesta Group"})]}),e.jsx("button",{onClick:r,className:"hover:rotate-90 transition-transform",children:e.jsx(C,{size:24})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:"Group Name"}),e.jsx("input",{className:"w-full border-2 border-gray-100 p-3 rounded-xl mt-1 outline-none focus:border-orange-500 transition-all",placeholder:"e.g. Project Vesta Team",value:m,onChange:t=>n(t.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:"Add Members (Gmail ID)"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("input",{className:"flex-1 border-2 border-gray-100 p-3 rounded-xl outline-none focus:border-orange-500 transition-all",placeholder:"friend@gmail.com",value:l,onChange:t=>o(t.target.value),onKeyDown:t=>t.key==="Enter"&&h()}),e.jsx("button",{onClick:h,className:"bg-orange-100 text-orange-600 p-3 rounded-xl hover:bg-orange-200 transition-colors",children:e.jsx(G,{size:24})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6 min-h-[40px] max-h-32 overflow-y-auto p-1",children:[x.length===0&&e.jsx("p",{className:"text-gray-300 text-sm italic",children:"No members added yet..."}),x.map(t=>e.jsxs("div",{className:"bg-orange-50 text-orange-600 px-3 py-1.5 rounded-full text-xs font-bold flex items-center gap-2 border border-orange-200",children:[t,e.jsx("button",{onClick:()=>b(t),className:"hover:text-red-500",children:e.jsx(C,{size:14})})]},t))]}),e.jsxs("button",{onClick:w,className:"w-full bg-orange-500 text-white py-4 rounded-2xl font-bold text-lg hover:bg-orange-600 shadow-lg shadow-orange-100 transition-all flex items-center justify-center gap-2",children:[e.jsx(se,{size:20}),"Launch Group"]})]})]})}):null},ue=({user:s})=>{const[r,c]=i.useState(null),[m,n]=i.useState([]),[l,o]=i.useState(""),[x,u]=i.useState(!1),[h,b]=i.useState("list");i.useEffect(()=>{const a=A(j(f,"rooms"),_("members","array-contains",s.email),M("updatedAt","desc")),d=E(a,g=>{n(g.docs.map(p=>({id:p.id,...p.data()})))});return()=>d()},[s.email]);const w=async()=>{const a=l.trim().toLowerCase();if(!a||a===s.email)return;const d=v(f,"users",a);if(!(await Y(d)).exists()){alert("User not found! They must log in to Vesta first.");return}[s.email,a].sort().join("_");try{await N(j(f,"rooms"),{type:"direct",members:[s.email,a],lastMessage:"New conversation",updatedAt:y()}),o("")}catch{o("")}},t=a=>{c(a),b("chat")};return e.jsxs("div",{className:"flex h-screen w-full bg-gray-100 overflow-hidden",children:[e.jsx(ge,{isOpen:x,onClose:()=>u(!1),userEmail:s.email}),e.jsx(L,{children:(h==="list"||window.innerWidth>=768)&&e.jsxs(z.div,{initial:{x:-400},animate:{x:0},exit:{x:-400},transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col w-full md:w-[400px] bg-white border-r border-gray-200 h-full shadow-lg",children:[e.jsxs("div",{className:"p-4 bg-white border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-orange-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold",children:"V"}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Vesta"})]}),e.jsx("button",{onClick:()=>k.signOut(),className:"p-2 text-gray-500 hover:text-red-500",children:e.jsx(te,{size:20})})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"w-full bg-gray-100 p-3 pl-10 rounded-full outline-none text-sm border border-gray-300 focus:border-orange-500",placeholder:"Search or start new chat...",value:l,onChange:a=>o(a.target.value),onKeyDown:a=>a.key==="Enter"&&w()}),e.jsx(re,{className:"absolute left-3 top-3 text-gray-400",size:18})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:m.map(a=>e.jsxs("div",{onClick:()=>t(a),className:`p-4 cursor-pointer flex items-center gap-3 hover:bg-gray-50 ${(r==null?void 0:r.id)===a.id?"bg-orange-50 border-r-4 border-orange-500":""}`,children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center text-orange-600 font-bold",children:a.type==="group"?e.jsx(U,{size:20}):a.members.find(d=>d!==s.email).charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-gray-800 truncate",children:a.type==="group"?a.name:a.members.find(d=>d!==s.email).split("@")[0]}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:a.lastMessage})]})]},a.id))}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.photoURL||`https://ui-avatars.com/api/?name=${s.displayName}&background=f97316&color=fff&size=48`,alt:s.displayName,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm text-gray-800 truncate",children:s.displayName}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.email})]})]})})]})}),e.jsx(L,{children:(h==="chat"||window.innerWidth>=768)&&e.jsx(z.div,{initial:{x:400},animate:{x:0},exit:{x:400},transition:{type:"spring",stiffness:300,damping:30},className:"flex-1 flex flex-col bg-[#e5ddd5] h-full",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"md:hidden flex items-center p-4 bg-white border-b border-gray-200",children:[e.jsx("button",{onClick:()=>b("list"),className:"p-2 text-orange-500",children:e.jsx(ne,{size:24})}),e.jsx("div",{className:"ml-2",children:e.jsx("p",{className:"font-bold text-gray-800",children:r.type==="group"?r.name:r.members.find(a=>a!==s.email).split("@")[0]})})]}),e.jsx(xe,{room:r,user:s})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center bg-[#e5ddd5]",children:[e.jsx(P,{size:80,className:"text-gray-400 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-600 mb-2",children:"Vesta Messenger"}),e.jsx("p",{className:"text-gray-500",children:"Encrypted & Fast"})]})})}),e.jsx("button",{onClick:()=>u(!0),className:"fixed bottom-6 right-6 bg-orange-500 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-orange-600 transition-colors",children:e.jsx(G,{size:24})})]})},fe=({message:s="Loading Vesta..."})=>e.jsxs("div",{className:"h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-50 to-orange-50",children:[e.jsx("div",{className:"bg-orange-500 p-4 rounded-3xl mb-6 shadow-lg shadow-orange-200 animate-spin",children:e.jsx(D,{size:40,className:"text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2 animate-pulse",children:s})]}),pe=()=>{const[s,r]=i.useState(!1),c=async()=>{r(!0);try{await Z(k,me)}catch(m){console.error("Login error:",m),r(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-50 via-orange-50 to-pink-50 p-4",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-orange-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-pink-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"}),e.jsx("div",{className:"absolute top-40 left-40 w-80 h-80 bg-yellow-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"})]}),e.jsxs("div",{className:"relative z-10 text-center max-w-md w-full",children:[e.jsx("div",{className:"mb-8 animate-bounce",children:e.jsx("div",{className:"bg-orange-500 p-6 rounded-3xl shadow-2xl shadow-orange-200 mx-auto w-fit",children:e.jsx(P,{size:48,className:"text-white"})})}),e.jsxs("h1",{className:"text-5xl font-black text-gray-800 mb-4 animate-fade-in-up",children:["Vesta ",e.jsx("span",{className:"text-orange-500",children:"Messenger"})]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 animate-fade-in-up animation-delay-500",children:"Connect, chat, and collaborate with your team in real-time"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-8 animate-fade-in-up animation-delay-1000",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white/80 backdrop-blur-md p-4 rounded-2xl shadow-lg",children:[e.jsx(le,{className:"text-orange-500",size:24}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Lightning Fast Messaging"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/80 backdrop-blur-md p-4 rounded-2xl shadow-lg",children:[e.jsx(ie,{className:"text-orange-500",size:24}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Secure & Private"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/80 backdrop-blur-md p-4 rounded-2xl shadow-lg",children:[e.jsx(oe,{className:"text-orange-500",size:24}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Group Collaboration"})]})]}),e.jsx("button",{onClick:c,disabled:s,className:"w-full flex items-center justify-center gap-3 bg-orange-500 text-white py-4 px-6 rounded-3xl font-bold text-lg hover:bg-orange-600 shadow-xl shadow-orange-200 transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed animate-fade-in-up animation-delay-1500",children:s?e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"https://www.gstatic.com/firebase/anonymous/google.png",className:"w-6 h-6",alt:"google"}),"Continue with Google"]})}),e.jsx("p",{className:"text-sm text-gray-500 mt-6 animate-fade-in-up animation-delay-2000",children:"Join thousands of users already chatting on Vesta"})]}),e.jsx("style",{jsx:!0,children:`
        @keyframes blob {
          0% { transform: translate(0px, 0px) scale(1); }
          33% { transform: translate(30px, -50px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
          100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob {
          animation: blob 7s infinite;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
        @keyframes fade-in-up {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.6s ease-out forwards;
        }
        .animation-delay-500 {
          animation-delay: 0.5s;
        }
        .animation-delay-1000 {
          animation-delay: 1s;
        }
        .animation-delay-1500 {
          animation-delay: 1.5s;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
      `})]})};function he(){const[s,r]=J(k);return i.useEffect(()=>{if(s){const c=v(f,"users",s.email);X(c,{email:s.email,displayName:s.displayName,photoURL:s.photoURL,lastSeen:y()},{merge:!0})}},[s]),r?e.jsx(fe,{}):e.jsx("div",{className:"h-screen bg-gradient-to-br from-slate-50 to-orange-50",children:s?e.jsx(ue,{user:s}):e.jsx(pe,{})})}I.createRoot(document.getElementById("root")).render(e.jsx(R.StrictMode,{children:e.jsx(he,{})}));
